# Using Ralphie

Ralphie is an autonomous AI coding loop with **80/20 compound engineering**: 80% planning (research + analysis), 20% execution.

## Quick Start

1. **Install skills** using [add-skill](https://github.com/vercel-labs/add-skill):
   ```bash
   npx add-skill skylarbarrera/ralphie
   ```
2. **Generate a spec** with research and analysis:
   ```bash
   ralphie spec "your project description"
   # Or interactive: /ralphie-spec "description" in Claude Code
   ```
3. **Run Ralphie**: `ralphie run --all`

### The 80/20 Workflow

When you run `ralphie spec`:
- **Research phase** (~60-90s): Two agents analyze your codebase and best practices
- **Spec generation**: AI creates structured spec informed by research
- **SpecFlow analysis**: Identifies edge cases and gaps

Then `ralphie run` executes task by task with fresh context each iteration.

## Project Structure

Ralphie uses a `.ralphie/` directory:

```
your-project/
├── .ralphie/
│   ├── specs/
│   │   ├── active/          # Current specs (generated by ralphie spec)
│   │   │   └── my-feature.md
│   │   └── completed/       # Archived specs (auto-moved)
│   ├── learnings/           # Captured failure→fix transitions
│   │   ├── build-errors/
│   │   ├── test-failures/
│   │   └── patterns/
│   ├── research-context.md  # Latest research findings
│   ├── state.txt            # Progress log (Ralphie updates this)
│   └── settings.json        # Project config
├── .claude/
│   └── CLAUDE.md            # Coding standards (if using Claude)
└── src/                     # Your code
```

## Writing a Spec (V2 Format)

Specs use task IDs and status tracking:

```markdown
# My Feature

Goal: Brief description of what you're building.

## Context

Background information for the AI implementing this spec.

## Tasks

### T001: Initialize project with TypeScript and testing
- Status: pending
- Size: M

**Deliverables:**
- TypeScript configuration with strict mode
- Vitest setup with coverage
- Basic project structure

**Verify:** `npm run type-check && npm test`

---

### T002: Set up database models
- Status: pending
- Size: M

**Deliverables:**
- User model with email, password hash, timestamps
- Post model with title, body, author reference
- Migration scripts

**Verify:** `npm run migrate && npm test`

---

### T003: Implement authentication system
- Status: pending
- Size: L

**Deliverables:**
- POST /auth/register endpoint
- POST /auth/login endpoint with JWT
- Auth middleware for protected routes
- Tests for all auth flows

**Verify:** `npm test -- auth`

---

## Acceptance Criteria

- WHEN user registers, THEN account is created with hashed password
- WHEN user logs in with valid credentials, THEN JWT is returned
```

### Task Design Principles

**One task = one logical unit of work.** Deliverables are implementation details.

| Size | Points | Description |
|------|--------|-------------|
| S | 1 | Single file, < 50 lines |
| M | 2 | Multiple files, 50-200 lines |
| L | 4 | Complex feature, 200+ lines |

**Batching heuristics:**
- Same feature? One task. (model + API + tests = T001)
- Files that import each other? One task.
- Sweet spot: 3-7 files per task

## Commands

```bash
# Spec generation
ralphie spec "description"           # Full workflow: research → spec → analysis
ralphie spec --skip-research "fix"   # Skip research phase
ralphie spec --skip-analyze "task"   # Skip analysis phase

# Running iterations
ralphie run              # Run one iteration
ralphie run --all        # Run until spec complete
ralphie run -n 5         # Run 5 iterations
ralphie run --review     # Multi-agent review before iteration

# Status and management
ralphie status           # Show progress
ralphie archive          # Move completed spec to archive
ralphie --help           # See all options
```

## The Loop

Each iteration, Ralphie:
1. Reads spec from `.ralphie/specs/active/` to find pending tasks
2. Implements the task with tests
3. Updates task status to `passed` or `failed`
4. Commits changes
5. Updates `.ralphie/state.txt`

### Compound Learning

When a task fails then passes, Ralphie captures:
- Root cause analysis
- Prevention rules
- Generated tests

Stored in `.ralphie/learnings/` for reuse. Each failure makes future runs better.

## Tips

- **Clean git state**: Ralphie requires no uncommitted changes before running
- **One task per iteration**: Tasks transition pending → in_progress → passed/failed
- **Check status**: Run `ralphie status` to see progress
- **Edit spec anytime**: Add/remove/reorder tasks between runs


# Progress Tracker
# Ralph appends completed tasks here after each iteration.
# This file helps Ralph understand what's been done and what's next.

✅ 2026-01-08: Implemented JSONL stream parser
  - Created src/lib/types.ts with TypeScript types for Claude messages and events
  - Created src/lib/stream-parser.ts with EventEmitter-based parser
  - Handles system, assistant, user, result envelope types
  - Emits init, tool_start, tool_end, text, result events
  - Correlates tool_use.id with tool_result.tool_use_id
  - Supports chunk-based parsing with buffering
  - Tests: 25 passing (95% coverage)
  - Commit: ca9595d feat(parser): add JSONL stream parser for Claude output

✅ 2026-01-08: Implemented state machine for iteration tracking
  - Created src/lib/state-machine.ts with StateMachine class
  - Tracks phases: idle, reading, editing, running, thinking, done
  - Categorizes tools: read (Read/Grep/Glob), write (Edit/Write), command (Bash), meta (TodoWrite/Task)
  - Coalesces consecutive tools of same category into groups
  - Generates display summaries (e.g., "Reading file.ts", "Editing 3 items")
  - Tracks stats: toolsStarted, toolsCompleted, toolsErrored, reads, writes, commands, metaOps
  - Tests: 41 passing (97% coverage)
  - Commit: 39c2e45 feat(state): add state machine for iteration tracking

✅ 2026-01-08: Added tool-categories module for configurable tool mapping
  - Created src/lib/tool-categories.ts with ToolCategory type and mappings
  - Icons: ◐ read, ✎ write, ⚡ command, ○ meta, ✓ done, ✗ error
  - Exports: TOOL_CATEGORIES, getToolCategory, getToolIcon, getCategoryVerb, getToolDisplayName
  - Refactored state-machine.ts to import from tool-categories.ts (removed duplication)
  - Tests: 30 passing (100% coverage)
  - Commit: 802598d feat(tools): add tool-categories module for configurable tool mapping

✅ 2026-01-08: Added JSONL logger for raw output tee to disk
  - Created src/lib/logger.ts with JsonlLogger class
  - Writes to ./runs/{ISO-timestamp}.jsonl files
  - Auto-creates runs directory if needed
  - Supports raw line logging (log) and object logging (logObject)
  - Gracefully handles close and circular reference errors
  - Tests: 18 passing (100% coverage)
  - Commit: e14a41b feat(logger): add JSONL logger for raw output tee to disk

✅ 2026-01-08: Created IterationHeader Ink component
  - Created src/components/IterationHeader.tsx - first terminal UI component
  - Displays iteration progress: `┌─ Iteration 1/10 ──── 0:42 elapsed`
  - formatElapsedTime helper handles seconds, minutes:seconds, hours:minutes:seconds
  - Added ink-testing-library for component testing
  - Tests: 13 passing
  - Commit: 3397c6f feat(ui): add IterationHeader Ink component

✅ 2026-01-08: Created TaskTitle Ink component
  - Created src/components/TaskTitle.tsx - displays task description
  - Shows first assistant text with play icon: `│ ▶ "Implementing JWT..."`
  - truncateText helper with configurable maxLength (default 60)
  - Handles empty/undefined text gracefully
  - Tests: 16 passing
  - Commit: 95171c4 feat(ui): add TaskTitle Ink component

✅ 2026-01-08: Created ToolItem Ink component
  - Created src/components/ToolItem.tsx - displays single tool status
  - Shows spinner for active tools, checkmark/error icon for completed
  - Category-based verb (Reading, Editing, Running, Processing)
  - Duration formatted in seconds with one decimal (e.g., 0.8s)
  - Color-coded icons per category and state
  - Tests: 18 passing
  - Commit: 8455922 feat(ui): add ToolItem Ink component

✅ 2026-01-08: Created ToolList Ink component
  - Created src/components/ToolList.tsx - coalesced tool display
  - Shows completed groups: "✓ Read 3 files (1.2s)"
  - Shows active tools individually with spinner
  - Error icon when group contains errors
  - Proper noun pluralization (file/files, command/commands)
  - Tests: 19 passing
  - Commit: 7bc8921 feat(ui): add ToolList Ink component

✅ 2026-01-08: Created StatusBar Ink component
  - Created src/components/StatusBar.tsx - bottom status bar
  - Displays phase label (Waiting..., Reading..., Editing..., Running..., Thinking..., Done)
  - Shows elapsed time in format matching IterationHeader
  - Supports custom summary text override
  - Visual style matches header: `└─ Done (2:14) ───────────`
  - Tests: 20 passing
  - Commit: cfc6f79 feat(ui): add StatusBar Ink component

✅ 2026-01-08: Created useClaudeStream React hook
  - Created src/hooks/useClaudeStream.ts - custom hook for claude process management
  - Spawns claude with --dangerously-skip-permissions --output-format stream-json -p
  - Parses JSONL stream using StreamParser, updates StateMachine
  - Returns reactive state: { phase, taskText, activeTools, toolGroups, stats, result, error, isRunning }
  - Handles idle timeout (kills process after N seconds of no output)
  - Cleans up process on unmount
  - Supports JSONL logging via saveJsonl option
  - Tests: 15 passing (integration tests for parser+machine combo)
  - Commit: c225b44 feat(hooks): add useClaudeStream React hook

✅ 2026-01-08: Created App.tsx main Ink component
  - Created src/App.tsx - composes all UI components into main App
  - Integrates IterationHeader, TaskTitle, ToolList, StatusBar
  - Uses useClaudeStream hook for state management
  - Shows error messages when present
  - _mockState prop enables testing without spawning claude process
  - Tests: 22 passing
  - Commit: d1d9da8 feat(ui): add App.tsx main Ink component

